@model IEnumerable<CloudComputingProject.Models.OrderItem>



<div class="cart-container">
    @foreach (var item in Model)
    {
        <div class="cart-item">
            <!-- Item details -->
            @if (item.ProductId > 0)
            {
                var products = ViewData["Products"] as List<Product>;
                if (products != null)
                {
                    var product = products.FirstOrDefault(p => p.Id == item.ProductId);
                    if (product != null)
                    {
                        <h5>@product.Name</h5>
                        <img src="@product.Url" alt="@product.Name" class="img-thumbnail" />
                        <p>Price: $@product.Price.ToString("0.00")</p>
                    }
                }
            }
            <!-- Flavors -->
            <div class="flavors">
                @if (!string.IsNullOrEmpty(item.Flavors))
                {
                    foreach (var flavor in item.Flavors.Split(','))
                    {
                        if (!string.IsNullOrEmpty(flavor))
                        {
                            var flavorId = int.Parse(flavor);
                            var flavors = ViewData["Flavors"] as List<Flavor>;
                            if (flavors != null)
                            {
                                var f = flavors.FirstOrDefault(p => p.Id == flavorId);
                                if (f != null)
                                {
                                    <img src="@f.FlavorUrl" alt="@f.FlavorName" class="flavor-image" />
                                }
                            }
                        }
                    }
                }
            </div>
            
            @if (ViewData["IsCartView"] as bool? == true)
            {
                <!-- Actions for cart view only -->
                <div class="actions">
                    @* <a href="@Url.Action("Details", new { id = item.Id })" class="btn btn-info btn-sm">Details</a> *@
                    @* <a href="@Url.Action("Edit", new { id = item.Id })" class="btn btn-primary btn-sm">Edit</a> *@

                      @*   <span class="remove-label" style="display: none;">Item Removed</span>
                        <form asp-action="Delete" asp-route-id="@item.Id" method="post" class="delete-form">
                            @Html.AntiForgeryToken()
                        
                    </form> *@
                    <div class="actions">
                        <form asp-action="Delete" asp-route-id="@item.Id" method="post" class="delete-form">
                            @Html.AntiForgeryToken()
                            <button type="submit" class="btn btn-danger btn-sm remove-button">Delete</button>
                        </form>
                    </div>
                   
</div>
            }
        </div>
    }
</div>



<style>
	.cart-container {
		display: flex;
		flex-wrap: wrap;
		gap: 20px;
	}

	.cart-item {
		border: 2px solid #007bff;
		padding: 20px;
		width: 300px;
	}

	.img-thumbnail {
		max-width: 100%;
		height: auto;
		border: 1px solid #ddd;
		border-radius: 5px;
	}

	.flavors {
		margin-top: 10px;
	}

	.flavor-image {
		max-width: 50px;
		height: auto;
		margin-right: 5px;
	}

    .remove-label {
        position: absolute;
        background-color: rgba(255, 0, 0, 0.7);
        color: white;
        padding: 5px 10px;
        border-radius: 5px;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 999;
    }
	.actions {
		margin-top: 10px;
	}
</style>
@section Scripts {
    <script>
        // JavaScript code to handle deletion and show the remove label
        $(document).ready(function () {
            $('.remove-button').click(function () {
                var form = $(this).closest('.delete-form');
                var removeLabel = form.siblings('.remove-label');

                $.ajax({
                    url: form.attr('action'),
                    method: 'POST',
                    data: form.serialize(),
                    success: function (data) {
                        if (data.success) {
                            removeLabel.show();
                            setTimeout(function () {
                                removeLabel.hide();
                            }, 2000); // Hide the label after 2 seconds (adjust as needed)
                            form.closest('.cart-item').remove();
                        }
                    }
                });

                return false; // Prevent the form from submitting normally
            });
        });
    </script>}